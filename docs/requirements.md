# kintone アプリバージョン管理システム 要件定義書

## 1. 概要

本システムは、kintoneアプリの構成情報をバックアップし、変更履歴を記録するためのシステムです。アプリ設定の変更を検出し、新しいバージョンとして記録することで、アプリの設定変更履歴を管理できます。

## 2. 目的

- kintoneアプリの構成情報のバックアップ
- アプリ設定の変更履歴の記録
- 設定変更差分の確認

## 3. システム構成

### 3.1 アプリ構成

本システムは以下のkintoneアプリで構成されています：

1. **アプリ一覧**（ID: 382）
   - kintone上の全アプリの情報を管理
   - JSONデータを格納するためのフィールドを持つ

2. **アプリバージョン管理システム**（ID: 374）
   - 各アプリのバージョン情報を記録
   - バージョン履歴を管理

3. **業務フロー図**（ID: 375）
   - システムの業務フローを記録

4. **データフロー図**（ID: 376）
   - システムのデータフローを記録

5. **ハブ**（ID: 383）
   - アプリ、業務フロー、データフローの関連付けを管理

### 3.2 技術構成

- TypeScript
   - kintone REST API
- Vite
- Vitest

## 4. 機能要件

### 4.1 基本機能

#### 4.1.1 アプリ情報取得機能
- アプリ一覧アプリのボタンクリックでgetAppsメソッドを実行
- 全アプリの情報を取得

#### 4.1.2 アプリ設定情報取得機能
- 各アプリIDに対してgetFormFields、getFormLayoutなどのメソッドを実行
- アプリの詳細設定情報を取得

#### 4.1.3 アプリ情報保存機能
- 取得した情報をアプリ一覧アプリにアプリIDをキーとして保存
- JSON形式で構造化データを保存

#### 4.1.4 バージョン比較機能
- 既存の最新バージョンとの差分を検出
- 変更があった場合のみ新バージョンとして登録

#### 4.1.5 バージョン登録機能
- アプリバージョン管理システムに新しいバージョンレコードを作成
- バージョン番号を自動的にインクリメント

## 5. 非機能要件

### 5.1 性能要件

- 複数アプリ（100アプリ以上）に対しても安定して動作すること

### 5.2 セキュリティ要件

- APIキーなどの認証情報はソースコードに直接記述しないこと
- アクセス権限のあるアプリのみバックアップ対象とすること

### 5.3 運用要件

- エラー発生時のログ記録
- バックアップ処理の実行結果通知

## 6. 開発フェーズ

### 6.1 第1フェーズ（基本機能実装）

実装は全てVitestによるテスト駆動開発でおこなうこと
- アプリ情報取得機能の実装
- アプリ設定情報取得機能の実装
- アプリ情報保存機能の実装
- バージョン比較機能の実装
- バージョン登録機能の実装

### 6.2 第2フェーズ（運用・保守）

- 運用モニタリング
- バグ修正
- 機能改善

## 7. その他

### 7.1 前提条件

- kintone環境が正常に動作していること
- 必要なkintoneアプリが作成されていること
- APIの実行権限が付与されていること

### 7.2 制約事項

- kintone APIの制限（リクエスト数制限など）に準拠すること
- 大量のデータを処理する場合のパフォーマンスに留意すること
- DOM操作は非推奨なのでおこなわないこと

## 8. 今後の拡張性

### 8.1 定期バックアップ機能
- 設定した間隔で自動的にバックアップを実行する機能
- スケジュール設定機能

### 8.2 差分表示機能
- バージョン間の差分を視覚的に表示する機能
- 変更点のハイライト表示

### 8.3 バージョン復元機能
- 過去のバージョンからアプリ設定を復元する機能
- ロールバック機能
